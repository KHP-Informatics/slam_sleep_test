<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SLAM Sleep v1.01</title>
<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">

<script src="app/lib/jquery-2.1.0.min.js"></script>
<script src="app/lib/lodash.min.js"></script>
<script src="app/lib/purple-robot-client.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>

<style>
.btn {width:100%;}
</style>

<script>

$( document ).ready(function() {
//put yer stuff here

/* AF: <!-- Make sure GPS information is captured every x mins, in order to integrate with accelerometer data from 1) fitbit 2) on-phone accelerometer or other activity measuring device, in order to produce a better measure of sleep and more importantly the user does not need to indicate when they are going to sleep / when the wake. The logic is the GPS coordinates will be static when asleep and accelerometer will measure restlessness. There are only a few other false positive scenarios where i) both devices have been put down, ii) charging accelerometer, iii)  --> */
/*
alert("just a test, ok doing something now");

//<!-- AF: pseudocode for location + fitbit sleep measure -->
try
{
    probesOn = PurpleRobotClient.probesState();
}
catch (err)
{
    alert("1. PurpleRobotClient.probesState error" + err);
}

if (probesOn == true)  //check if Probes are enabled, alert to enable in PR?
{
    //alert client that they are not 
    alert("2. Check Probes are enabled in Purple Robot App. \n check: Purple Robot > Probe Configuration > Enable Probes");
}

try
{
    PurpleRobotClient.enableProbe('edu.northwestern.cbits.purple_robot_manager.probes.builtin.LocationProbe'); //enabble Location Probe if not enabled, or direct user to enable
}
catch (err)
{
    //do something or throw
    alert("3. PurpleRobotClient.enableProbe error" + err);
}

try
{
    conf_obj = { 'name':'edu.northwestern.cbits.purple_robot_manager.probes.builtin.LocationProbe', 'frequency':'300000', 'enabled':true };
    PurpleRobotClient.updateProbe(conf_obj); // set the required option: "Sampling Rate" = 5 min, must have at least sample rate 5 mins
}
catch (err)
{
    //do something or throw
    alert("4. PurpleRobotClient.updateProbe error" + err);
}
*/
// AF: maybe setup some optional conf which specifies the set of probes and configures them at recommended values -- otherwise somewhat labourious for the user to do.

// AF: to help with battery management, maybe have broad category of sample rates [e.g. low, med, high] (lowest=minimum sample rates where the data is useful), warn user if below this.

$(".jumbotron").html("<h3>SLAM Sleep v1.01</h3>");

});

$(".main-form").on("submit", function(ev){

	ev.preventDefault();
        try
        {
            PurpleRobotClient.lient.emitReading("bed_time",$("#bed_time").val());
            PurpleRobotClient.emitReading("wake_time",$("#wake_time").val());
            PurpleRobotClient.emitReading("feeling_good_bad",$("#feeling_good_bad").val());
            
            #test here
            conf_obj = { 'name':'edu.northwestern.cbits.purple_robot_manager.probes.builtin.LocationProbe', 'frequency':'300000', 'enabled':true };
            PurpleRobotClient.updateProbe(conf_obj); // set the required option: "Sampling Rate" = 5 min, must have at least sample rate 5 mins
        }
        catch (err)
        {
            alert("5. error thrown in form js" + err);
        }
});





</script>

</head>

<body>
	<div class="jumbotron"></div>

	<div class="container">
                <!-- feedback simple sleep data, perhaps in first instance as a table? or graphic? -->
                <div class="" >
                    <img src="http://radiocarla.com/wp-content/uploads/2013/09/FitBit_Flex-Sleep2.jpg" alt="Sleep Dummy Image (Activity + GPS)" height=80% width=80% />
                </div>

		<form role="form" id="main-form">  
                        <div class="gps-group">
                        
                        <div class="form-group">
				<label>What time did you go to bed last night?</label><br/>
				<input type="time" name="bed_time" id="bed_time">
			</div>
			<div class="form-group">
				<label>What time did wake up this morning?</label><br/>
				<input type="time" name="wake_time" id="wake_time">
			</div>
			<div class="form-group">
				<label>How did you feel?</label><br/>
				<input type="range" name="feeling_good_bad" min="0" max="10" id="feeling_good_bad">
			</div>
			<button type="submit" class="btn btn-primary">Save</button>
		</form>
	</div>

</body>
</html>
